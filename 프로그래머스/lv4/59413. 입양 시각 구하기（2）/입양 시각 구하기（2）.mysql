WITH RECURSIVE TIME_SET AS(
    SELECT 0 AS HOUR
    
    UNION ALL

    SELECT HOUR + 1 FROM TIME_SET WHERE HOUR < 23
)

SELECT
    HOUR,
    COUNT(ANIMAL_ID) AS COUNT
FROM 
    TIME_SET
LEFT JOIN
    ANIMAL_OUTS ON HOUR = HOUR(DATETIME)
GROUP BY
    HOUR
    